# Engine 配置文件示例
# 定义所有可用的 Engine 和 Pipeline → Engine 映射关系

# ============================================
# Engine 定义
# ============================================
engines:
  # ========== RunningHub 云端工作流（推荐使用） ==========
  # RunningHub 姿势迁移工作流
  runninghub_pose_transfer:
    type: runninghub
    config:
      api_key: "84427127c24546879969f10983fe578a"  # RunningHub API Key
      workflow_id: "1996080571212349442"  # 工作流 ID（.ai 国际版）
      api_base_url: "https://www.runninghub.ai"  # API 基础 URL（国际版，服务器在国外）
      timeout: 300  # 超时时间（5 分钟），超时后提示用户人数过多
      poll_interval: 8  # 轮询间隔（秒，增加到 8 秒以减少请求频率，避免在请求量大时频繁超时）
  
  # RunningHub 换头工作流
  runninghub_head_swap:
    type: runninghub
    config:
      api_key: "84427127c24546879969f10983fe578a"  # RunningHub API Key（与其他工作流相同）
      workflow_id: "1996469641855770625"  # 换头工作流 ID
      api_base_url: "https://www.runninghub.ai"  # API 基础 URL（国际版）
      timeout: 300  # 超时时间（5 分钟）
      poll_interval: 8  # 轮询间隔（秒）
      # 节点映射配置（根据工作流 JSON 文件确认）
      node_mapping:
        head_image:  # input:head_image:1 - 模特脸部特写图片（节点 #6）
          node_id: "6"
          field_name: "image"
        cloth_image:  # input:cloth_image:2 - 服装图片（节点 #7）
          node_id: "7"
          field_name: "image"
  
  # RunningHub 换背景工作流
  runninghub_background_change:
    type: runninghub
    config:
      api_key: "84427127c24546879969f10983fe578a"  # RunningHub API Key（与其他工作流相同）
      workflow_id: "1996478152513830914"  # 换背景工作流 ID
      api_base_url: "https://www.runninghub.ai"  # API 基础 URL（国际版）
      timeout: 300  # 超时时间（5 分钟）
      poll_interval: 8  # 轮询间隔（秒）
      # 节点映射配置（根据工作流 JSON 文件确认）
      node_mapping:
        model_image:  # input:model_image:1 - 模特图片（节点 #2）
          node_id: "2"
          field_name: "image"
        bg_image:  # input:bg_image:2 - 背景图片（节点 #3）
          node_id: "3"
          field_name: "image"
  
  # ========== 已废弃的引擎（不再使用） ==========
  # 人脸检测 API（已废弃）
  # face_detection_api:
  #   type: external_api
  #   config:
  #     api_url: "https://api.example.com/face-detection"
  #     api_key: "${FACE_DETECTION_API_KEY}"
  #     timeout: 30
  
  # 人脸替换 API（已废弃）
  # face_swap_api:
  #   type: external_api
  #   config:
  #     api_url: "https://api.example.com/face-swap"
  #     api_key: "${FACE_SWAP_API_KEY}"
  #     timeout: 60
  
  # 人像分割 API（已废弃）
  # segmentation_api:
  #   type: external_api
  #   config:
  #     api_url: "https://api.example.com/segmentation"
  #     api_key: "${SEGMENTATION_API_KEY}"
  #     timeout: 30
  
  # ComfyUI 换头工作流（已废弃）
  # comfyui_head_swap:
  #   type: comfyui
  #   config:
  #     comfyui_url: "http://localhost:8188"
  #     workflow_path: "./workflows/head_swap_workflow.json"
  #     timeout: 300
  
  # ComfyUI 换背景工作流（已废弃）
  # comfyui_background:
  #   type: comfyui
  #   config:
  #     comfyui_url: "http://localhost:8188"
  #     workflow_path: "./workflows/background_workflow.json"
  #     timeout: 300
  
  # ComfyUI 姿势迁移工作流（已废弃 - 已替换为 RunningHub）
  # comfyui_pose_transfer:
  #   type: comfyui
  #   config:
  #     comfyui_url: "${COMFYUI_BASE_URL}"
  #     workflow_path: "./workflows/pose_swap_workflow.json"
  #     timeout: 300
  #     poll_interval: 2

# ============================================
# Pipeline 配置
# ============================================
pipelines:
  # 换头 Pipeline（使用 RunningHub）
  head_swap:
    enabled: true
    steps:
      head_swap:
        engine: runninghub_head_swap  # 使用 RunningHub 换头引擎
        description: "RunningHub 换头工作流"
  
  # 换背景 Pipeline（使用 RunningHub）
  background_change:
    enabled: true
    steps:
      background_change:
        engine: runninghub_background_change  # 使用 RunningHub 换背景引擎
        description: "RunningHub 换背景工作流"
  
  # 换姿势 Pipeline（使用 RunningHub）
  pose_change:
    enabled: true
    steps:
      pose_transfer:
        engine: runninghub_pose_transfer  # 使用 RunningHub 引擎
        description: "RunningHub 姿势迁移工作流"

# ============================================
# 全局配置
# ============================================
global:
  # 重试配置
  retry:
    max_attempts: 3
    retry_delay: 2  # 秒
  
  # 超时配置
  timeout:
    default: 60
    max: 300
  
  # 缓存配置（可选）
  cache:
    enabled: false
    ttl: 3600  # 秒

